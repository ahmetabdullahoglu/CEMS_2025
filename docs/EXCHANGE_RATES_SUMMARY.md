# ملخص أسعار الصرف في النظام
# Exchange Rates Summary

## نظرة عامة

يحتوي النظام على **56 سعر صرف** (28 زوج ثنائي الاتجاه) تغطي **8 عملات** مختلفة.

---

## العملات المتاحة

| الرمز | الاسم بالإنجليزية | الاسم بالعربية | الرمز الخاص | عملة أساسية |
|------|-------------------|----------------|-------------|-------------|
| USD  | US Dollar         | دولار أمريكي   | $           | ✅ نعم      |
| EUR  | Euro              | يورو           | €           | ❌ لا       |
| TRY  | Turkish Lira      | ليرة تركية     | ₺           | ❌ لا       |
| GBP  | British Pound     | جنيه إسترليني  | £           | ❌ لا       |
| SAR  | Saudi Riyal       | ريال سعودي     | ﷼           | ❌ لا       |
| AED  | UAE Dirham        | درهم إماراتي   | د.إ         | ❌ لا       |
| JPY  | Japanese Yen      | ين ياباني      | ¥           | ❌ لا       |
| EGP  | Egyptian Pound    | جنيه مصري      | E£          | ❌ لا       |

---

## أسعار صرف USD (العملة الأساسية)

جميع العملات لديها أسعار صرف مباشرة من وإلى الدولار الأمريكي (USD).

### USD → جميع العملات

| من   | إلى  | السعر      | سعر الشراء | سعر البيع  | الوصف                    |
|------|------|-----------|-----------|-----------|-------------------------|
| USD  | EUR  | 0.92      | 0.91      | 0.93      | دولار إلى يورو          |
| USD  | TRY  | 32.50     | 32.40     | 32.60     | دولار إلى ليرة تركية    |
| USD  | GBP  | 0.79      | 0.78      | 0.80      | دولار إلى جنيه إسترليني |
| USD  | SAR  | 3.75      | 3.74      | 3.76      | دولار إلى ريال سعودي    |
| USD  | AED  | 3.67      | 3.66      | 3.68      | دولار إلى درهم إماراتي  |
| USD  | JPY  | 149.50    | 149.00    | 150.00    | دولار إلى ين ياباني     |
| USD  | EGP  | 49.00     | 48.80     | 49.20     | دولار إلى جنيه مصري     |

### جميع العملات → USD

| من   | إلى  | السعر      | سعر الشراء | سعر البيع  | الوصف                    |
|------|------|-----------|-----------|-----------|-------------------------|
| EUR  | USD  | 1.087     | 1.08      | 1.09      | يورو إلى دولار          |
| TRY  | USD  | 0.0308    | 0.0307    | 0.0309    | ليرة تركية إلى دولار    |
| GBP  | USD  | 1.266     | 1.25      | 1.28      | جنيه إسترليني إلى دولار |
| SAR  | USD  | 0.267     | 0.265     | 0.269     | ريال سعودي إلى دولار    |
| AED  | USD  | 0.272     | 0.270     | 0.274     | درهم إماراتي إلى دولار  |
| JPY  | USD  | 0.0067    | 0.0066    | 0.0068    | ين ياباني إلى دولار     |
| EGP  | USD  | 0.0204    | 0.0203    | 0.0205    | جنيه مصري إلى دولار     |

---

## الأسعار المتقاطعة (Cross Rates)

بالإضافة إلى أسعار USD، يحتوي النظام على أسعار مباشرة بين عملات أخرى:

### EUR - أزواج اليورو

| من   | إلى  | السعر  | الوصف              |
|------|------|-------|-------------------|
| EUR  | TRY  | 35.33 | يورو → ليرة تركية  |
| EUR  | GBP  | 0.86  | يورو → جنيه        |
| EUR  | SAR  | 4.08  | يورو → ريال        |
| EUR  | AED  | 3.99  | يورو → درهم        |
| EUR  | EGP  | 53.30 | يورو → جنيه مصري   |

### GBP - أزواج الجنيه الإسترليني

| من   | إلى  | السعر   | الوصف                   |
|------|------|--------|------------------------|
| GBP  | TRY  | 41.14  | جنيه → ليرة تركية       |
| GBP  | SAR  | 4.75   | جنيه → ريال             |
| GBP  | AED  | 4.65   | جنيه → درهم             |
| GBP  | JPY  | 189.20 | جنيه → ين               |
| GBP  | EGP  | 62.00  | جنيه → جنيه مصري        |
| GBP  | EUR  | 1.163  | جنيه → يورو (معكوس)     |

### TRY - أزواج الليرة التركية

| من   | إلى  | السعر   | الوصف                |
|------|------|--------|---------------------|
| TRY  | EUR  | 0.0283 | ليرة → يورو          |
| TRY  | GBP  | 0.0243 | ليرة → جنيه          |
| TRY  | SAR  | 0.115  | ليرة → ريال          |
| TRY  | AED  | 0.113  | ليرة → درهم          |
| TRY  | JPY  | 4.60   | ليرة → ين            |
| TRY  | EGP  | 1.51   | ليرة → جنيه مصري     |

### SAR - أزواج الريال السعودي

| من   | إلى  | السعر  | الوصف               |
|------|------|-------|---------------------|
| SAR  | EUR  | 0.245 | ريال → يورو          |
| SAR  | GBP  | 0.211 | ريال → جنيه          |
| SAR  | TRY  | 8.67  | ريال → ليرة          |
| SAR  | AED  | 0.978 | ريال → درهم          |
| SAR  | JPY  | 39.87 | ريال → ين            |
| SAR  | EGP  | 13.07 | ريال → جنيه مصري     |

### AED - أزواج الدرهم الإماراتي

| من   | إلى  | السعر  | الوصف                |
|------|------|-------|---------------------|
| AED  | EUR  | 0.251 | درهم → يورو          |
| AED  | GBP  | 0.215 | درهم → جنيه          |
| AED  | TRY  | 8.86  | درهم → ليرة          |
| AED  | SAR  | 1.023 | درهم → ريال          |
| AED  | JPY  | 40.74 | درهم → ين            |
| AED  | EGP  | 13.35 | درهم → جنيه مصري     |

### JPY - أزواج الين الياباني

| من   | إلى  | السعر   | الوصف            |
|------|------|--------|-----------------|
| JPY  | GBP  | 0.0053 | ين → جنيه        |
| JPY  | TRY  | 0.217  | ين → ليرة        |
| JPY  | SAR  | 0.025  | ين → ريال        |
| JPY  | AED  | 0.025  | ين → درهم        |
| JPY  | EGP  | 0.328  | ين → جنيه مصري   |

### EGP - أزواج الجنيه المصري

| من   | إلى  | السعر   | الوصف             |
|------|------|--------|------------------|
| EGP  | EUR  | 0.0188 | جنيه مصري → يورو  |
| EGP  | GBP  | 0.0161 | جنيه مصري → جنيه  |
| EGP  | TRY  | 0.663  | جنيه مصري → ليرة  |
| EGP  | SAR  | 0.0765 | جنيه مصري → ريال  |
| EGP  | AED  | 0.0749 | جنيه مصري → درهم  |
| EGP  | JPY  | 3.05   | جنيه مصري → ين    |

---

## مصفوفة التغطية الكاملة

| من ↓ / إلى → | USD | EUR | TRY | GBP | SAR | AED | JPY | EGP |
|-------------|-----|-----|-----|-----|-----|-----|-----|-----|
| **USD**     | -   | ✅  | ✅  | ✅  | ✅  | ✅  | ✅  | ✅  |
| **EUR**     | ✅  | -   | ✅  | ✅  | ✅  | ✅  | ❌  | ✅  |
| **TRY**     | ✅  | ✅  | -   | ✅  | ✅  | ✅  | ✅  | ✅  |
| **GBP**     | ✅  | ✅  | ✅  | -   | ✅  | ✅  | ✅  | ✅  |
| **SAR**     | ✅  | ✅  | ✅  | ✅  | -   | ✅  | ✅  | ✅  |
| **AED**     | ✅  | ✅  | ✅  | ✅  | ✅  | -   | ✅  | ✅  |
| **JPY**     | ✅  | ❌  | ✅  | ✅  | ✅  | ✅  | -   | ✅  |
| **EGP**     | ✅  | ✅  | ✅  | ✅  | ✅  | ✅  | ✅  | -   |

### الأزواج المفقودة

الأزواج التالية **غير موجودة مباشرة** لكن يمكن حسابها عبر USD:

1. **EUR → JPY** ❌ (يمكن حسابها: EUR→USD→JPY)
2. **JPY → EUR** ❌ (يمكن حسابها: JPY→USD→EUR)

> **ملاحظة:** النظام يدعم الحساب التلقائي عبر USD كعملة وسيطة، لذلك جميع التحويلات ممكنة حتى للأزواج المفقودة!

---

## إحصائيات

### إجمالي التغطية

- **إجمالي العملات:** 8 عملات
- **إجمالي الأسعار المباشرة:** 56 سعر (28 زوج × 2 اتجاه)
- **أسعار USD الأساسية:** 14 سعر (7 عملات × 2 اتجاه)
- **الأسعار المتقاطعة:** 42 سعر (21 زوج × 2 اتجاه)
- **نسبة التغطية المباشرة:** 87.5% (56 من 64 ممكن)
- **نسبة التغطية الكلية:** 100% (مع الحساب عبر USD)

### توزيع الأسعار حسب العملة

| العملة | أسعار مباشرة إلى | أسعار مباشرة من | المجموع |
|--------|------------------|-----------------|---------|
| USD    | 7                | 7               | 14      |
| EUR    | 6                | 6               | 12      |
| TRY    | 7                | 7               | 14      |
| GBP    | 7                | 7               | 14      |
| SAR    | 7                | 7               | 14      |
| AED    | 7                | 7               | 14      |
| JPY    | 6                | 6               | 12      |
| EGP    | 7                | 7               | 14      |

---

## أمثلة على الاستخدام

### مثال 1: تحويل مباشر (موجود)
```python
# SAR → EGP (موجود مباشرة)
rate = await currency_service.get_latest_rate("SAR", "EGP")
# النتيجة: 13.07
```

### مثال 2: تحويل عبر USD (غير موجود مباشرة)
```python
# EUR → JPY (غير موجود مباشرة، يحسب عبر USD)
rate = await currency_service.get_latest_rate("EUR", "JPY")
# النظام يحسب: EUR→USD (1.087) × USD→JPY (149.50) = 162.51
```

### مثال 3: تجميع أرصدة
```python
balances = [
    {'currency_code': 'TRY', 'amount': Decimal('100000')},
    {'currency_code': 'SAR', 'amount': Decimal('10000')},
    {'currency_code': 'EGP', 'amount': Decimal('50000')}
]

# تجميع بالدولار
result = await currency_service.aggregate_balances(balances, "USD")
# النتيجة:
# TRY 100,000 → 3,080.00 USD
# SAR 10,000  → 2,670.00 USD
# EGP 50,000  → 1,020.00 USD
# المجموع: 6,770.00 USD
```

---

## ملاحظات مهمة

1. **USD كعملة أساسية:** جميع العملات مرتبطة بـ USD مما يسمح بالتحويل بين أي عملتين
2. **أسعار ثنائية الاتجاه:** كل زوج له سعرين (من A إلى B ومن B إلى A)
3. **أسعار الشراء/البيع:** كل سعر له ثلاث قيم (standard, buy, sell)
4. **الحساب التلقائي:** النظام يحسب الأسعار المفقودة تلقائياً عبر USD
5. **دقة الحسابات:** الأسعار المحسوبة قد تختلف قليلاً عن الأسعار المباشرة

---

## التحديثات المستقبلية

للحصول على تغطية 100% مباشرة، يمكن إضافة:
- EUR ↔ JPY (زوج واحد، اتجاهين)

لكن هذا **اختياري** لأن النظام يحسبها تلقائياً عبر USD.

---

**آخر تحديث:** 2025-11-10
**الملف المصدر:** `scripts/seed_currencies.py`
